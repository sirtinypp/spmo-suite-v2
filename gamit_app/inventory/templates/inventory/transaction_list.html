{% extends 'layout.html' %}
{% load humanize %}

{% block content %}
<div class="container-fluid fade-in">
    
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2 class="h4 fw-bold text-body-emphasis mb-0">
            <i class="fas fa-history text-primary me-2"></i>Transaction History Overview
        </h2>
        
        {% if not request.user.is_superuser %}
        <div class="dropdown">
            <button class="btn btn-primary dropdown-toggle shadow-sm" type="button" data-bs-toggle="dropdown">
                <i class="fas fa-plus-circle me-2"></i>New Request
            </button>
            <ul class="dropdown-menu dropdown-menu-end border-0 shadow">
                <li><a class="dropdown-item py-2" href="{% url 'create_inspection_request' %}"><i class="fas fa-search me-2 text-info"></i>Inspection Request</a></li>
                <li><a class="dropdown-item py-2" href="{% url 'create_transfer_request' %}"><i class="fas fa-exchange-alt me-2 text-warning"></i>Asset Transfer</a></li>
                <li><a class="dropdown-item py-2" href="{% url 'create_batch_request' %}"><i class="fas fa-boxes-packing me-2 text-success"></i>Batch Acquisition</a></li>
            </ul>
        </div>
        {% endif %}
    </div>

    <div class="row g-4 mb-5">
        <div class="col-md-3">
            <div class="card stat-card shadow-sm border-0 border-start border-primary border-4 bg-body-tertiary">
                <div class="card-body d-flex justify-content-between align-items-center">
                    <div>
                        <h6 class="text-body-secondary text-uppercase mb-1">Total Requests</h6>
                        <h3 class="fw-bold text-body-emphasis">{{ metrics.total|intcomma }}</h3>
                    </div>
                    <div class="icon-box text-primary fs-2 opacity-50"><i class="fas fa-database"></i></div>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card stat-card shadow-sm border-0 border-start border-warning border-4 bg-body-tertiary">
                <div class="card-body d-flex justify-content-between align-items-center">
                    <div>
                        <h6 class="text-body-secondary text-uppercase mb-1">Pending Review</h6>
                        <h3 class="fw-bold text-warning">{{ metrics.pending|intcomma }}</h3>
                    </div>
                    <div class="icon-box text-warning fs-2 opacity-50"><i class="fas fa-hourglass-half"></i></div>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card stat-card shadow-sm border-0 border-start border-success border-4 bg-body-tertiary">
                <div class="card-body d-flex justify-content-between align-items-center">
                    <div>
                        <h6 class="text-body-secondary text-uppercase mb-1">Total Approved</h6>
                        <h3 class="fw-bold text-success">{{ metrics.approved|intcomma }}</h3>
                    </div>
                    <div class="icon-box text-success fs-2 opacity-50"><i class="fas fa-check-double"></i></div>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card stat-card shadow-sm border-0 border-start border-danger border-4 bg-body-tertiary">
                <div class="card-body d-flex justify-content-between align-items-center">
                    <div>
                        <h6 class="text-body-secondary text-uppercase mb-1">Total Returned</h6>
                        <h3 class="fw-bold text-danger">{{ metrics.returned|intcomma }}</h3>
                    </div>
                    <div class="icon-box text-danger fs-2 opacity-50"><i class="fas fa-undo"></i></div>
                </div>
            </div>
        </div>
    </div>
    
    {% with breakdown=metrics.office_breakdown %}
        {% if breakdown %}
            <div class="alert alert-info bg-opacity-10 border-info border-start border-4 small py-2 mb-4 text-body-emphasis" role="alert">
                <i class="fas fa-bell me-2"></i> 
                <strong>INSIGHT:</strong> The <strong>{{ breakdown.requestor_office|default:"Unassigned" }}</strong> office currently holds the highest demand with <strong>{{ breakdown.pending_count }}</strong> pending requests.
            </div>
        {% endif %}
    {% endwith %}

    <ul class="nav nav-pills mb-4" id="pills-tab" role="tablist">
        <li class="nav-item" role="presentation">
            <button class="nav-link active fw-bold" id="pills-inspection-tab" data-bs-toggle="pill" data-bs-target="#pills-inspection" type="button">
                <i class="fas fa-search me-2"></i>Inspection Requests
            </button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link fw-bold" id="pills-transfer-tab" data-bs-toggle="pill" data-bs-target="#pills-transfer" type="button">
                <i class="fas fa-exchange-alt me-2"></i>Asset Accountability Transfer
            </button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link fw-bold" id="pills-batch-tab" data-bs-toggle="pill" data-bs-target="#pills-batch" type="button">
                <i class="fas fa-boxes-packing me-2"></i>Batch Acquisitions
            </button>
        </li>
    </ul>

    <div class="tab-content" id="pills-tabContent">
        
        <div class="tab-pane fade show active" id="pills-inspection">
            <div class="card border-0 shadow-sm overflow-hidden bg-body-tertiary">
                <div class="table-responsive">
                    <table class="table table-hover align-middle mb-0 text-body">
                        <thead class="bg-body-tertiary text-uppercase small fw-bold text-body-secondary"> 
                            <tr>
                                <th style="width: 15%;" class="ps-4 py-3">Transaction ID</th>
                                <th style="width: 25%;" class="py-3">Asset Details</th>
                                <th style="width: 12%;" class="py-3">Date</th>
                                <th style="width: 18%;" class="py-3">Requested By</th>
                                <th style="width: 15%;" class="py-3">Status</th>
                                <th style="width: 8%;" class="text-center py-3">Details</th>
                                {% if request.user.is_superuser %}<th style="width: 7%;" class="text-center py-3">Action</th>{% endif %}
                            </tr>
                        </thead>
                        <tbody>
                            {% for item in inspections %}
                            <tr class="text-body-emphasis border-bottom"> 
                                <td class="ps-4 fw-bold text-primary">{{ item.transaction_id }}</td>
                                <td>
                                    <div class="fw-bold text-body-emphasis">{{ item.asset.property_number }}</div>
                                    <div class="small text-body-secondary text-truncate" style="max-width: 250px;">{{ item.asset.name }}</div>
                                </td>
                                <td class="text-body-secondary">{{ item.created_at|date:"M d, Y" }}</td>
                                <td>
                                    <div class="fw-semibold text-body-emphasis">{{ item.requestor.get_full_name|default:item.requestor.username }}</div>
                                    <div class="small text-body-secondary">{{ item.requestor.userprofile.office|default:"N/A" }}</div>
                                </td>
                                <td>
                                    {% if item.status == 'Approved' %}<span class="badge bg-success bg-opacity-10 text-success border border-success rounded-pill px-3">Approved</span>
                                    {% elif item.status == 'Returned' %}<span class="badge bg-warning bg-opacity-10 text-warning border border-warning rounded-pill px-3">Returned</span>
                                    {% elif item.status == 'Rejected' %}<span class="badge bg-danger bg-opacity-10 text-danger border border-danger rounded-pill px-3">Rejected</span>
                                    {% else %}<span class="badge bg-secondary bg-opacity-10 text-secondary border border-secondary rounded-pill px-3">Pending</span>{% endif %}
                                </td>
                                <td class="text-center">
                                    <button class="btn btn-sm btn-light border shadow-sm" type="button" data-bs-toggle="collapse" data-bs-target="#inspect-{{ item.id }}">
                                        <i class="fas fa-chevron-down text-secondary"></i>
                                    </button>
                                </td>
                                {% if request.user.is_superuser %}
                                <td class="text-center">
                                    {% if item.status == 'Pending Inspection' or item.status == 'PENDING' %}
                                    <div class="btn-group shadow-sm">
                                        <button class="btn btn-sm btn-success" data-bs-toggle="modal" data-bs-target="#actionModal" data-action-url="{% url 'update_request_status' pk=item.id action='approve' %}" data-action-type="approve"><i class="fas fa-check"></i></button>
                                        <button class="btn btn-sm btn-danger" data-bs-toggle="modal" data-bs-target="#actionModal" data-action-url="{% url 'update_request_status' pk=item.id action='return' %}" data-action-type="return"><i class="fas fa-undo"></i></button>
                                    </div>
                                    {% endif %}
                                </td>
                                {% endif %}
                            </tr>
                            <tr>
                                <td colspan="{% if request.user.is_superuser %}7{% else %}6{% endif %}" class="p-0 border-0">
                                    <div class="collapse bg-body-tertiary border-bottom" id="inspect-{{ item.id }}">
                                        <div class="p-4">
                                            <div class="row">
                                                <div class="col-md-6 border-end border-secondary-subtle">
                                                    <h6 class="small fw-bold text-body-secondary text-uppercase mb-2">Request Notes</h6>
                                                    <p class="small text-body-emphasis mb-3">{{ item.notes }}</p>
                                                    
                                                    <h6 class="small fw-bold text-body-secondary text-uppercase mb-2">Attached Documents</h6>
                                                    <div class="d-flex gap-2">
                                                        {% if item.document_1 %}<a href="{{ item.document_1.url }}" target="_blank" class="badge bg-white text-primary border border-primary text-decoration-none py-2 px-3"><i class="fas fa-file me-1"></i> Document 1</a>{% endif %}
                                                        {% if item.document_2 %}<a href="{{ item.document_2.url }}" target="_blank" class="badge bg-white text-primary border border-primary text-decoration-none py-2 px-3"><i class="fas fa-file me-1"></i> Document 2</a>{% endif %}
                                                        {% if not item.document_1 and not item.document_2 %}<span class="small text-muted fst-italic">No documents attached.</span>{% endif %}
                                                    </div>
                                                </div>
                                                <div class="col-md-6 ps-4">
                                                    <h6 class="small fw-bold text-body-secondary text-uppercase mb-2">Admin Remarks</h6>
                                                    <div class="p-3 bg-white rounded border border-secondary-subtle shadow-sm">
                                                        <p class="small fst-italic mb-0 text-body-secondary">{{ item.admin_remarks|default:"No remarks provided." }}</p>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            {% empty %}
                            <tr><td colspan="8" class="text-center py-5 text-muted fst-italic">No inspection requests found.</td></tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <div class="tab-pane fade" id="pills-transfer">
            <div class="card border-0 shadow-sm overflow-hidden bg-body-tertiary">
                <div class="table-responsive">
                    <table class="table table-hover align-middle mb-0 text-body">
                        <thead class="bg-body-tertiary text-uppercase small fw-bold text-body-secondary">
                            <tr>
                                <th style="width: 15%;" class="ps-4 py-3">Transaction ID</th>
                                <th style="width: 20%;" class="py-3">Asset</th>
                                <th style="width: 18%;" class="py-3">From Officer</th>
                                <th style="width: 18%;" class="py-3">To Officer</th>
                                <th style="width: 15%;" class="py-3">Status</th>
                                <th style="width: 7%;" class="text-center py-3">Details</th>
                                {% if request.user.is_superuser %}<th style="width: 7%;" class="text-center py-3">Action</th>{% endif %}
                            </tr>
                        </thead>
                        <tbody>
                            {% for item in transfers %}
                            <tr class="text-body-emphasis border-bottom">
                                <td class="ps-4 fw-bold text-warning">{{ item.transaction_id }}</td>
                                <td>
                                    <div class="fw-bold text-body-emphasis">{{ item.asset.property_number }}</div>
                                    <div class="small text-body-secondary text-truncate" style="max-width: 200px;">{{ item.asset.name }}</div>
                                </td>
                                <td class="text-body-secondary small">{{ item.current_officer }}</td>
                                <td class="fw-bold text-body-emphasis small">{{ item.new_officer_firstname }} {{ item.new_officer_surname }}</td>
                                <td>
                                    {% if item.status == 'APPROVED' %}<span class="badge bg-success bg-opacity-10 text-success border border-success rounded-pill px-3">Approved</span>
                                    {% elif item.status == 'RETURNED' %}<span class="badge bg-warning bg-opacity-10 text-warning border border-warning rounded-pill px-3">Returned</span>
                                    {% elif item.status == 'REJECTED' %}<span class="badge bg-danger bg-opacity-10 text-danger border border-danger rounded-pill px-3">Rejected</span>
                                    {% else %}<span class="badge bg-secondary bg-opacity-10 text-secondary border border-secondary rounded-pill px-3">Pending</span>{% endif %}
                                </td>
                                <td class="text-center">
                                    <button class="btn btn-sm btn-light border shadow-sm" type="button" data-bs-toggle="collapse" data-bs-target="#transfer-{{ item.id }}">
                                        <i class="fas fa-chevron-down text-secondary"></i>
                                    </button>
                                </td>
                                {% if request.user.is_superuser %}
                                <td class="text-center">
                                    {% if item.status == 'PENDING' %}
                                    <div class="btn-group shadow-sm">
                                        <button class="btn btn-sm btn-success" data-bs-toggle="modal" data-bs-target="#actionModal" data-action-url="{% url 'update_transfer_status' pk=item.id action='approve' %}" data-action-type="approve"><i class="fas fa-check"></i></button>
                                        <button class="btn btn-sm btn-danger" data-bs-toggle="modal" data-bs-target="#actionModal" data-action-url="{% url 'update_transfer_status' pk=item.id action='return' %}" data-action-type="return"><i class="fas fa-undo"></i></button>
                                    </div>
                                    {% endif %}
                                </td>
                                {% endif %}
                            </tr>
                            <tr>
                                <td colspan="{% if request.user.is_superuser %}8{% else %}7{% endif %}" class="p-0 border-0">
                                    <div class="collapse bg-body-tertiary border-bottom" id="transfer-{{ item.id }}">
                                        <div class="p-4">
                                            <div class="row">
                                                <div class="col-md-6 border-end border-secondary-subtle">
                                                    <h6 class="small fw-bold text-body-secondary text-uppercase mb-2">Reason for Transfer</h6>
                                                    <p class="small text-body-emphasis mb-3">{{ item.remarks }}</p>
                                                    <h6 class="small fw-bold text-body-secondary text-uppercase mb-2">Requested By</h6>
                                                    <p class="small text-body-emphasis mb-3">{{ item.requestor.get_full_name }} ({{ item.requestor.userprofile.office }})</p>

                                                    <h6 class="small fw-bold text-body-secondary text-uppercase mb-2">Documents</h6>
                                                    <div class="d-flex gap-2">
                                                        {% if item.document_1 %}<a href="{{ item.document_1.url }}" target="_blank" class="badge bg-white text-primary border border-primary text-decoration-none py-2 px-3"><i class="fas fa-file-alt me-1"></i> ITR Form</a>{% endif %}
                                                        {% if item.document_2 %}<a href="{{ item.document_2.url }}" target="_blank" class="badge bg-white text-primary border border-primary text-decoration-none py-2 px-3"><i class="fas fa-id-card me-1"></i> Valid ID</a>{% endif %}
                                                    </div>
                                                </div>
                                                <div class="col-md-6 ps-4">
                                                    <h6 class="small fw-bold text-body-secondary text-uppercase mb-2">Admin Remarks</h6>
                                                    <div class="p-3 bg-white rounded border border-secondary-subtle shadow-sm">
                                                        <p class="small fst-italic mb-0 text-body-secondary">{{ item.admin_remarks|default:"No remarks provided." }}</p>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            {% empty %}
                            <tr><td colspan="9" class="text-center py-5 text-muted fst-italic">No transfer requests found.</td></tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <div class="tab-pane fade" id="pills-batch">
            <div class="card border-0 shadow-sm overflow-hidden bg-body-tertiary">
                <div class="table-responsive">
                    <table class="table table-hover align-middle mb-0 text-body">
                        <thead class="bg-body-tertiary text-uppercase small fw-bold text-body-secondary">
                            <tr>
                                <th style="width: 15%;" class="ps-4 py-3">Batch ID</th>
                                <th style="width: 15%;" class="py-3">Date</th>
                                <th style="width: 25%;" class="py-3">Requested By</th>
                                <th style="width: 15%;" class="py-3">Status</th>
                                <th style="width: 15%;" class="text-center py-3">Action/Review</th>
                                {% if request.user.is_superuser %}<th style="width: 15%;" class="text-center py-3">Decision</th>{% endif %}
                            </tr>
                        </thead>
                        <tbody>
                            {% for batch in batches %}
                            <tr class="text-body-emphasis border-bottom">
                                <td class="ps-4 fw-bold text-success">{{ batch.transaction_id }}</td>
                                <td>{{ batch.created_at|date:"M d, Y" }}</td>
                                <td>
                                    <div class="fw-semibold text-body-emphasis">{{ batch.requestor.get_full_name|default:batch.requestor.username }}</div>
                                    <div class="small text-body-secondary">{{ batch.requesting_unit|default:batch.requestor.userprofile.office }}</div>
                                </td>
                                <td>
                                    {% if batch.status == 'APPROVED' %}<span class="badge bg-success bg-opacity-10 text-success border border-success rounded-pill px-3">Approved</span>
                                    {% elif batch.status == 'RETURNED' %}<span class="badge bg-warning bg-opacity-10 text-warning border border-warning rounded-pill px-3">Returned</span>
                                    {% else %}<span class="badge bg-secondary bg-opacity-10 text-secondary border border-secondary rounded-pill px-3">Pending</span>{% endif %}
                                </td>
                                
                                <td class="text-center">
                                    <div class="btn-group shadow-sm">
                                        <button class="btn btn-sm btn-light border" type="button" data-bs-toggle="collapse" data-bs-target="#batch-{{ batch.id }}">
                                            <i class="fas fa-eye text-secondary me-1"></i> Review
                                        </button>
                                        
                                        {% if request.user.is_superuser %}
                                        <a href="{% url 'process_batch_admin' pk=batch.id %}" class="btn btn-sm btn-light border text-primary" title="Process Items">
                                            <i class="fas fa-edit"></i>
                                        </a>
                                        {% endif %}
                                    </div>
                                </td>

                                {% if request.user.is_superuser %}
                                <td class="text-center">
                                    {% if batch.status == 'PENDING' %}
                                    <div class="btn-group shadow-sm">
                                        <button class="btn btn-sm btn-success" data-bs-toggle="modal" data-bs-target="#actionModal" data-action-url="{% url 'update_batch_status' pk=batch.id action='approve' %}" data-action-type="approve"><i class="fas fa-check"></i></button>
                                        <button class="btn btn-sm btn-danger" data-bs-toggle="modal" data-bs-target="#actionModal" data-action-url="{% url 'update_batch_status' pk=batch.id action='return' %}" data-action-type="return"><i class="fas fa-undo"></i></button>
                                    </div>
                                    {% endif %}
                                </td>
                                {% endif %}
                            </tr>
                            <tr>
                                <td colspan="{% if request.user.is_superuser %}6{% else %}5{% endif %}" class="p-0 border-0">
                                    <div class="collapse bg-body-tertiary border-bottom" id="batch-{{ batch.id }}">
                                        <div class="p-4">
                                            <div class="row">
                                                <div class="col-md-7 border-end border-secondary-subtle">
                                                    
                                                    <div class="row g-3 mb-4">
                                                        <div class="col-sm-6">
                                                            <label class="small text-muted fw-bold text-uppercase d-block mb-1" style="font-size: 0.7rem;">Supplier</label>
                                                            <span class="fw-bold text-body-emphasis">{{ batch.supplier_name|default:"-" }}</span>
                                                        </div>
                                                        <div class="col-sm-6">
                                                            <label class="small text-muted fw-bold text-uppercase d-block mb-1" style="font-size: 0.7rem;">PO Number</label>
                                                            <span class="text-body-emphasis">{{ batch.po_number|default:"-" }}</span>
                                                        </div>
                                                        <div class="col-sm-6">
                                                            <label class="small text-muted fw-bold text-uppercase d-block mb-1" style="font-size: 0.7rem;">Invoice No.</label>
                                                            <span class="text-body-emphasis">{{ batch.sales_invoice_number|default:"-" }}</span>
                                                        </div>
                                                        <div class="col-sm-6">
                                                            <label class="small text-muted fw-bold text-uppercase d-block mb-1" style="font-size: 0.7rem;">IAR Number</label>
                                                            <span class="text-body-emphasis">{{ batch.acceptance_report_number|default:"-" }}</span>
                                                        </div>
                                                    </div>

                                                    <h6 class="small fw-bold text-body-secondary text-uppercase mb-2">Justification</h6>
                                                    <p class="small text-body-emphasis mb-3">{{ batch.remarks|default:"No justification provided." }}</p>

                                                    <h6 class="small fw-bold text-body-secondary text-uppercase mb-2">Attached Documents</h6>
                                                    <div class="d-flex flex-wrap gap-2">
                                                        {% if batch.doc_1_file %}<a href="{{ batch.doc_1_file.url }}" target="_blank" class="badge bg-white text-primary border border-primary text-decoration-none py-2 px-3"><i class="fas fa-paperclip me-1"></i>{{ batch.doc_1_name }}</a>{% endif %}
                                                        {% if batch.doc_2_file %}<a href="{{ batch.doc_2_file.url }}" target="_blank" class="badge bg-white text-primary border border-primary text-decoration-none py-2 px-3"><i class="fas fa-paperclip me-1"></i>{{ batch.doc_2_name }}</a>{% endif %}
                                                        {% if batch.doc_3_file %}<a href="{{ batch.doc_3_file.url }}" target="_blank" class="badge bg-white text-primary border border-primary text-decoration-none py-2 px-3"><i class="fas fa-paperclip me-1"></i>{{ batch.doc_3_name }}</a>{% endif %}
                                                        {% if not batch.doc_1_file and not batch.doc_2_file and not batch.doc_3_file %}<span class="small text-muted fst-italic">No documents attached.</span>{% endif %}
                                                    </div>
                                                </div>
                                                
                                                <div class="col-md-5 ps-4">
                                                    <h6 class="small fw-bold text-body-secondary text-uppercase mb-2">Admin Remarks</h6>
                                                    <div class="p-3 bg-white rounded border border-secondary-subtle shadow-sm">
                                                        <p class="small fst-italic mb-0 text-body-secondary">{{ batch.admin_remarks|default:"No feedback provided yet." }}</p>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            {% empty %}
                            <tr><td colspan="6" class="text-center py-5 text-muted fst-italic">No batch requests found.</td></tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

    </div>
</div>

<div class="modal fade" id="actionModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content bg-body-tertiary">
      <form method="POST" id="actionForm">
        {% csrf_token %}
        <div class="modal-header border-bottom border-secondary-subtle">
            <h5 class="modal-title text-body-emphasis" id="modalTitle">Confirm Action</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
            <p id="modalMessage" class="text-body-emphasis">Are you sure?</p>
            <textarea class="form-control" name="admin_remarks" rows="3" placeholder="Enter remarks (required for return)..."></textarea>
        </div>
        <div class="modal-footer border-top border-secondary-subtle">
            <button type="submit" class="btn btn-primary" id="modalSubmitBtn">Confirm</button>
        </div>
      </form>
    </div>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function () {
    const actionModal = document.getElementById('actionModal');
    const actionForm = document.getElementById('actionForm');
    const modalTitle = document.getElementById('modalTitle');
    const modalMessage = document.getElementById('modalMessage');
    const modalSubmitBtn = document.getElementById('modalSubmitBtn');
    
    actionModal.addEventListener('show.bs.modal', function (event) {
        const button = event.relatedTarget;
        
        const actionURL = button.getAttribute('data-action-url');
        const actionType = button.getAttribute('data-action-type');

        actionForm.action = actionURL;

        if (actionType === 'approve') {
            modalTitle.innerText = "Approve Request";
            modalTitle.className = "modal-title text-success";
            modalMessage.innerText = "You are about to APPROVE this request. Add final remarks:";
            modalSubmitBtn.className = "btn btn-success";
            modalSubmitBtn.innerText = "Approve";
        } else if (actionType === 'return') {
            modalTitle.innerText = "Return Request";
            modalTitle.className = "modal-title text-danger";
            modalMessage.innerText = "You are about to RETURN this request. Please specify the reason:";
            modalSubmitBtn.className = "btn btn-danger";
            modalSubmitBtn.innerText = "Return";
        }
    });
});
</script>
{% endblock %}